<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robustness Test Fixture</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .section { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; }
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 100; display: none;
        }
    </style>
</head>
<body>
    <h1>Browser Automation Robustness Test</h1>

    <div class="section">
        <h3>1. Shadow DOM</h3>
        <div id="shadow-host"></div>
    </div>

    <div class="section">
        <h3>2. Delayed Interaction</h3>
        <button id="delayed-btn" disabled>Wait for me...</button>
        <div id="delayed-output"></div>
    </div>

    <div class="section">
        <h3>3. Obscured Element</h3>
        <button id="obscured-btn">I am covered</button>
        <div id="overlay"></div>
        <button id="toggle-overlay">Toggle Overlay</button>
    </div>

    <div class="section">
        <h3>4. New Tab</h3>
        <a href="about:blank" target="_blank" id="new-tab-link">Open New Tab</a>
    </div>

    <script>
        // 1. Shadow DOM Setup
        const shadowHost = document.getElementById('shadow-host');
        const shadowRoot = shadowHost.attachShadow({mode: 'open'});
        const shadowBtn = document.createElement('button');
        shadowBtn.textContent = "Shadow Button";
        shadowBtn.onclick = () => console.log('Shadow button clicked!');
        shadowRoot.appendChild(shadowBtn);

        // 2. Delayed Interaction
        const delayedBtn = document.getElementById('delayed-btn');
        setTimeout(() => {
            delayedBtn.disabled = false;
            delayedBtn.textContent = "Click Me Now";
        }, 2000);
        delayedBtn.onclick = () => document.getElementById('delayed-output').textContent = "Clicked!";

        // 3. Obscured Element
        const overlay = document.getElementById('overlay');
        const toggleBtn = document.getElementById('toggle-overlay');
        toggleBtn.onclick = () => {
            overlay.style.display = overlay.style.display === 'block' ? 'none' : 'block';
        };
        // Start obscured
        overlay.style.display = 'block';
        setTimeout(() => overlay.style.display = 'none', 3000); // Auto-clear after 3s
    </script>
</body>
</html>